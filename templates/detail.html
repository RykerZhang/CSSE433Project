<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Pokemon Encyclopedia</title>
    <link rel="stylesheet" href="{{style}}">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Material+Icons">
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
</head>


<body id="detailPage">

    <nav class="navbar navbar-expand navbar-dark bg-dark" aria-label="Third navbar example">
        <div class="container-fluid">
            <a class="navbar-brand" href="/main">Pokemon</a>

            <div class="collapse navbar-collapse" id="nav-container">
                <ul class="navbar-nav me-auto mb-2 mb-sm-0">
                    <li class="nav-item">
                        <a class="nav-link" href="#"><button class="bg-dark text-white border-0" id="updateButton"
                                type="button" class="btn btn-light">
                                <i class="material-icons">update</i> Update</button></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#"><button class="bg-dark text-white border-0" data-bs-toggle="modal"
                                data-bs-target="#delete" id="deleteButton" type="button" class="btn btn-light">
                                <i class="material-icons">delete</i> Delete</button></a>
                    </li>

                </ul>

                <div class="nav-item dropdown text-white">
                    <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown" aria-expanded="false"><i
                            class="material-icons">settings</i>Setting</a>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="#">Log Out</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>

    <div id="main">

        <img id=img>
        <fieldset disabled>
            <div class="row g-3 justify-content-center" disabled>
                <div class="col-md-2">
                    <label for="name" class="form-label">name-form</label>
                    <input type="text" class="form-control " id="name">
                </div>
                <div class="col-md-2">
                    <label for="type1" class="form-label">type1</label>
                    <input type="text" class="form-control " id="type1">
                </div>
                <div class="col-md-2">
                    <label for="type2" class="form-label">type2</label>
                    <input type="text" class="form-control " id="type2">
                </div>
                <div class="col-md-2">
                    <label for="species" class="form-label">species</label>
                    <input type="text" class="form-control " id="species">
                </div>
                <div class="col-md-2">
                    <label for="abilities" class="form-label">abilities</label>
                    <input type="text" class="form-control " id="abilities">
                </div>
            </div>
            <div class=" row g-3 justify-content-center" disabled>
                <div class="col-md-2">
                    <label for="height" class="form-label">height</label>
                    <input type="text" class="form-control " id="height">
                </div>
                <div class="col-md-2">
                    <label for="weight" class="form-label">weight</label>
                    <input type="text" class="form-control " id="weight">
                </div>
                <div class="col-md-2">
                    <label for="catch_rate" class="form-label">catch rate</label>
                    <input type="text" class="form-control " id="catch_rate">
                </div>
                <div class="col-md-2">
                    <label for="base_exp" class="form-label">base exp</label>
                    <input type="text" class="form-control " id="base_exp">
                </div>
                <div class="col-md-2">
                    <label for="grow_rate" class="form-label">growth rate</label>
                    <input type="text" class="form-control " id="grow_rate">
                </div>
            </div>

            <div class=" row g-3 justify-content-center" disabled>
                <div class="col-md-2">
                    <label for="male" class="form-label">male rate</label>
                    <input type="text" class="form-control " id="male">
                </div>
                <div class="col-md-2">
                    <label for="female" class="form-label">female rate</label>
                    <input type="text" class="form-control " id="female">
                </div>
            </div>
            <div class=" row g-3 justify-content-center" disabled>
                <div class="col-md-1">
                    <label for="hp" class="form-label">hp</label>
                    <input type="text" class="form-control " id="hp">
                </div>
                <div class="col-md-1">
                    <label for="attack" class="form-label">attack</label>
                    <input type="text" class="form-control " id="attack">
                </div>
                <div class="col-md-1">
                    <label for="defense" class="form-label">defense</label>
                    <input type="text" class="form-control " id="defense">
                </div>
                <div class="col-md-1">
                    <label for="sp_atk" class="form-label">sp attack</label>
                    <input type="text" class="form-control " id="sp_atk">
                </div>
                <div class="col-md-1">
                    <label for="sp_def" class="form-label">sp defense</label>
                    <input type="text" class="form-control " id="sp_def">
                </div>
                <div class="col-md-1">
                    <label for="speed" class="form-label">speed</label>
                    <input type="text" class="form-control " id="speed">
                </div>
            </div>
        </fieldset>
    </div>
    <br>
    <div class="row justify-content-center">
        <div class="col-4">
            <button type="button" class="btn btn-outline-primary invisible" style="width:100%"
                id="submitUpdate">update</button>
        </div>
        <div class="col-4">
            <button type="button" class="btn btn-outline-primary" style="width:100%" id="revolution">Evolution</button>
        </div>
    </div>

    <div class="modal fade" id="delete" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
        aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="staticBackdropLabel">Delete</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div>
                        This process CANNOT be undo.
                    </div>
                    <div class="mb-3">
                        <label for="deleteIn" class="form-label">Type "DELETE" below to confirm</label>
                        <input type="text" class="form-control" id="deleteIn">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-light" id="deleteBtn">Delete</button>
                </div>
            </div>
        </div>
    </div>

    </div>



    <!-- JavaScript Bundle with Popper -->
    <script src="{{script}}"></script>
    <script>
        var data = {{ pokemon| tojson }};
        console.log(data);
        var id = data[0];
        var name_form = data[1];
        var type1 = data[2];
        var type2 = data[3];
        var species = data[4];
        var height = data[5];
        var weight = data[6];
        var abilities = data[7];
        var training_catch_rate = data[8];
        var training_base_exp = data[9];
        var training_growth_rate = data[10];
        var breeding_gender_male = data[11];
        var breeding_gender_female = data[12];
        var stats_hp = data[13];
        var stats_attack = data[14];
        var stats_defense = data[15];
        var stats_sp_atk = data[16];
        var stats_sp_def = data[17];
        var stats_speed = data[18];
        var stats_total = data[19];
        var img = data[20];
        // var

        document.querySelector("#img").src = img;
        document.querySelector("#name").value = name_form;
        document.querySelector("#type1").value = type1;
        document.querySelector("#type2").value = type2;
        document.querySelector("#species").value = species;
        document.querySelector("#abilities").value = abilities;
        document.querySelector("#height").value = height;
        document.querySelector("#weight").value = weight;
        document.querySelector("#catch_rate").value = training_catch_rate;
        document.querySelector("#base_exp").value = training_catch_rate;
        document.querySelector("#grow_rate").value = training_catch_rate;
        document.querySelector("#male").value = breeding_gender_male;
        document.querySelector("#female").value = breeding_gender_female;
        document.querySelector("#hp").value = stats_hp;
        document.querySelector("#attack").value = stats_attack;
        document.querySelector("#defense").value = stats_defense;
        document.querySelector("#sp_atk").value = stats_sp_atk;
        document.querySelector("#sp_def").value = stats_sp_def;
        document.querySelector("#speed").value = stats_speed;





        document.querySelector("#updateButton").onclick = (event) => {
            document.querySelector("fieldset").disabled = !document.querySelector("fieldset").disabled
            if (document.querySelector("#submitUpdate").classList.contains("invisible")) {
                document.querySelector("#submitUpdate").classList.remove("invisible");
            } else {
                document.querySelector("#submitUpdate").classList.add("invisible");
            }
            console.log(document.querySelector("#submitUpdate"));
        };
        document.querySelector("#submitUpdate").onclick = (event) => {
            const data = [];
            data[0] = id;
            data[1] = document.querySelector("#name").value;
            if (!data[1]) {
                window.alert("name can't be null");
            }
            data[2] = document.querySelector("#type1").value || "-";
            data[3] = document.querySelector("#type2").value || "-";
            data[4] = document.querySelector("#species").value || "-";
            data[5] = document.querySelector("#height").value || "0";
            data[6] = document.querySelector("#weight").value || "0";
            data[7] = document.querySelector("#abilities").value || "-";
            data[8] = document.querySelector("#catch_rate").value || "0";
            data[9] = document.querySelector("#base_exp").value || "0";
            data[10] = document.querySelector("#grow_rate").value || "0";
            data[11] = document.querySelector("#male").value || "0";
            data[12] = document.querySelector("#female").value || "0";
            data[13] = document.querySelector("#hp").value || "0";
            data[14] = document.querySelector("#attack").value || "0";
            data[15] = document.querySelector("#defense").value || "0";
            data[16] = document.querySelector("#sp_atk").value || "0";
            data[17] = document.querySelector("#sp_def").value || "0";
            data[18] = document.querySelector("#speed").value || "0";
            data[19] = String(
                Number(hp) +
                Number(attack) +
                Number(defense) +
                Number(sp_atk) +
                Number(sp_def) +
                Number(speed)
            );
            data[20] = document.querySelector("#img").src || "-";
            fetch("/Update", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(data),
            }).then((response) => {
                window.location.reload();
            });
        };
        document.querySelector("#deleteBtn").onclick = (event) => {
            if (document.querySelector("#deleteIn").value == "DELETE") {
                var url = "/Delete/" + String(id);
                console.log(url);
                fetch("/Delete/" + id, { method: "DELETE" }).then((response) => {
                    window.location.href = "/main";
                })
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3"
        crossorigin="anonymous"></script>
</body>

</html>